<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 Simulating Allotetraploid Data | hespresso ☕</title>
  <meta name="description" content="5.1 Simulating Allotetraploid Data | hespresso ☕" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 Simulating Allotetraploid Data | hespresso ☕" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 Simulating Allotetraploid Data | hespresso ☕" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="evaluation-framework.html"/>
<link rel="next" href="simulating-allohexaploid-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>hespresso</a></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> Installation</a></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> Quick Start</a></li>
<li class="chapter" data-level="3" data-path="tutorials.html"><a href="tutorials.html"><i class="fa fa-check"></i><b>3</b> Tutorials</a>
<ul>
<li class="chapter" data-level="3.1" data-path="allohexaploid-c.-flexuosa.html"><a href="allohexaploid-c.-flexuosa.html"><i class="fa fa-check"></i><b>3.1</b> Allohexaploid <em>C. flexuosa</em></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="allohexaploid-c.-flexuosa.html"><a href="allohexaploid-c.-flexuosa.html#introduction"><i class="fa fa-check"></i><b>3.1.1</b> Introduction</a></li>
<li class="chapter" data-level="3.1.2" data-path="allohexaploid-c.-flexuosa.html"><a href="allohexaploid-c.-flexuosa.html#data-preparation"><i class="fa fa-check"></i><b>3.1.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.1.3" data-path="allohexaploid-c.-flexuosa.html"><a href="allohexaploid-c.-flexuosa.html#hobit"><i class="fa fa-check"></i><b>3.1.3</b> HOBIT</a></li>
<li class="chapter" data-level="3.1.4" data-path="allohexaploid-c.-flexuosa.html"><a href="allohexaploid-c.-flexuosa.html#homeoroq"><i class="fa fa-check"></i><b>3.1.4</b> HomeoRoq</a></li>
<li class="chapter" data-level="3.1.5" data-path="allohexaploid-c.-flexuosa.html"><a href="allohexaploid-c.-flexuosa.html#analysis-environment"><i class="fa fa-check"></i><b>3.1.5</b> Analysis Environment</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="allohexaploid-t.-aestivum.html"><a href="allohexaploid-t.-aestivum.html"><i class="fa fa-check"></i><b>3.2</b> Allohexaploid <em>T. aestivum</em></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="allohexaploid-t.-aestivum.html"><a href="allohexaploid-t.-aestivum.html#introduction-1"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="allohexaploid-t.-aestivum.html"><a href="allohexaploid-t.-aestivum.html#data-preparation-1"><i class="fa fa-check"></i><b>3.2.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.2.3" data-path="allohexaploid-t.-aestivum.html"><a href="allohexaploid-t.-aestivum.html#statistical-test"><i class="fa fa-check"></i><b>3.2.3</b> Statistical Test</a></li>
<li class="chapter" data-level="3.2.4" data-path="allohexaploid-t.-aestivum.html"><a href="allohexaploid-t.-aestivum.html#combining-subgenomes"><i class="fa fa-check"></i><b>3.2.4</b> Combining Subgenomes</a></li>
<li class="chapter" data-level="3.2.5" data-path="allohexaploid-t.-aestivum.html"><a href="allohexaploid-t.-aestivum.html#analysis-environment-1"><i class="fa fa-check"></i><b>3.2.5</b> Analysis Environment</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="allotriploid-c.-insueta.html"><a href="allotriploid-c.-insueta.html"><i class="fa fa-check"></i><b>3.3</b> Allotriploid <em>C. insueta</em></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="allotriploid-c.-insueta.html"><a href="allotriploid-c.-insueta.html#introduction-2"><i class="fa fa-check"></i><b>3.3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.3.2" data-path="allotriploid-c.-insueta.html"><a href="allotriploid-c.-insueta.html#data-preparation-2"><i class="fa fa-check"></i><b>3.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.3.3" data-path="allotriploid-c.-insueta.html"><a href="allotriploid-c.-insueta.html#statistical-test-1"><i class="fa fa-check"></i><b>3.3.3</b> Statistical Test</a></li>
<li class="chapter" data-level="3.3.4" data-path="allotriploid-c.-insueta.html"><a href="allotriploid-c.-insueta.html#analysis-environment-2"><i class="fa fa-check"></i><b>3.3.4</b> Analysis Environment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hobit-1.html"><a href="hobit-1.html"><i class="fa fa-check"></i><b>4.1</b> HOBIT</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hobit-1.html"><a href="hobit-1.html#inputs"><i class="fa fa-check"></i><b>4.1.1</b> Inputs</a></li>
<li class="chapter" data-level="4.1.2" data-path="hobit-1.html"><a href="hobit-1.html#test"><i class="fa fa-check"></i><b>4.1.2</b> Test</a></li>
<li class="chapter" data-level="4.1.3" data-path="hobit-1.html"><a href="hobit-1.html#outputs"><i class="fa fa-check"></i><b>4.1.3</b> Outputs</a></li>
<li class="chapter" data-level="4.1.4" data-path="hobit-1.html"><a href="hobit-1.html#options"><i class="fa fa-check"></i><b>4.1.4</b> Options</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="homeoroq-1.html"><a href="homeoroq-1.html"><i class="fa fa-check"></i><b>4.2</b> HomeoRoq</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="homeoroq-1.html"><a href="homeoroq-1.html#inputs-1"><i class="fa fa-check"></i><b>4.2.1</b> Inputs</a></li>
<li class="chapter" data-level="4.2.2" data-path="homeoroq-1.html"><a href="homeoroq-1.html#test-1"><i class="fa fa-check"></i><b>4.2.2</b> Test</a></li>
<li class="chapter" data-level="4.2.3" data-path="homeoroq-1.html"><a href="homeoroq-1.html#outputs-1"><i class="fa fa-check"></i><b>4.2.3</b> Outputs</a></li>
<li class="chapter" data-level="4.2.4" data-path="homeoroq-1.html"><a href="homeoroq-1.html#options-1"><i class="fa fa-check"></i><b>4.2.4</b> Options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="evaluation-framework.html"><a href="evaluation-framework.html"><i class="fa fa-check"></i><b>5</b> Evaluation Framework</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulating-allotetraploid-data.html"><a href="simulating-allotetraploid-data.html"><i class="fa fa-check"></i><b>5.1</b> Simulating Allotetraploid Data</a></li>
<li class="chapter" data-level="5.2" data-path="simulating-allohexaploid-data.html"><a href="simulating-allohexaploid-data.html"><i class="fa fa-check"></i><b>5.2</b> Simulating Allohexaploid Data</a></li>
<li class="chapter" data-level="5.3" data-path="custom-data-simulation.html"><a href="custom-data-simulation.html"><i class="fa fa-check"></i><b>5.3</b> Custom Data Simulation</a></li>
<li class="chapter" data-level="5.4" data-path="evaluation-framework-1.html"><a href="evaluation-framework-1.html"><i class="fa fa-check"></i><b>5.4</b> Evaluation Framework</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="citations.html"><a href="citations.html"><i class="fa fa-check"></i>Citations</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>hespresso</em> ☕</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulating-allotetraploid-data" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Simulating Allotetraploid Data<a href="simulating-allotetraploid-data.html#simulating-allotetraploid-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <span class="pkg-name"><a href="https://bitdessin.github.io/hespresso" target="_blank">hespresso</a></span> package provides functions
to simulate artificial read counts for allotetraploid and allohexaploid species.
By default, the simulation generates read counts
for an allotetraploid with 10,000 homeologs across two conditions,
each with three biological replicates.
The mean and dispersion parameters are estimated
from real RNA-Seq data from an allotetraploid <em>Cardamine flexuosa</em> dataset <span class="citation">(Akiyama et al. 2021)</span>.</p>
<p>To generate a simulated dataset with default options, run as follows.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="simulating-allotetraploid-data.html#cb97-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sim_homeolog_counts</span>()</span>
<span id="cb97-2"><a href="simulating-allotetraploid-data.html#cb97-2" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## # 2 subgenomes (A, B)
## # 10000 homeologs
## ---------------------
## Experiment Design:
##     group replicate
## 1 group_1         1
## 2 group_1         2
## 3 group_1         3
## 4 group_2         1
## 5 group_2         2
## 6 group_2         3
## ---------------------
## &gt; subgenome: A 
##        group_1__1 group_1__2 group_1__3 group_2__1 group_2__2 group_2__3
## gene_1         27         22         16         14         14         22
## gene_2        278          4         12         87        113         93
## gene_3        614        316        433        437        228        631
## gene_4        360        341        311        359        237        411
## gene_5        138         42        214        150        189        165
## gene_6       1028       1063       1171        383        385        342
## +++++++++++++++++++++
## &gt; subgenome: B 
##        group_1__1 group_1__2 group_1__3 group_2__1 group_2__2 group_2__3
## gene_1          9         21         11         21         19         21
## gene_2        124        107        123        218        187        200
## gene_3        162        149        206        180        235        259
## gene_4        373        329        384        353        269        374
## gene_5         63         45         69         75         49         43
## gene_6        101         93        102         67         98         83
## ---------------------</code></pre>
<p>Options can be flexibly customized by users.
For example, to simulate data with 1,000 homeologs and 5 replicates per condition,
run as follows.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="simulating-allotetraploid-data.html#cb99-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sim_homeolog_counts</span>(<span class="at">n_gene =</span> <span class="dv">1000</span>, <span class="at">n_replicates =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb99-2"><a href="simulating-allotetraploid-data.html#cb99-2" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## # 2 subgenomes (A, B)
## # 1000 homeologs
## ---------------------
## Experiment Design:
##      group replicate
## 1  group_1         1
## 2  group_1         2
## 3  group_1         3
## 4  group_1         4
## 5  group_1         5
## 6  group_2         1
## 7  group_2         2
## 8  group_2         3
## 9  group_2         4
## 10 group_2         5
## ---------------------
## &gt; subgenome: A 
##        group_1__1 group_1__2 group_1__3 group_1__4 group_1__5 group_2__1 group_2__2 group_2__3 group_2__4 group_2__5
## gene_1         59         58         58         51         47         70         43         71         53         45
## gene_2          8          2          5         36         13          6          9          6          7          6
## gene_3          4          4          4          4          9          0          0          1          8          0
## gene_4         27         34         34         28         18          8          6         10         18         15
## gene_5         52         43         32         54         37         31         10          5         22         10
## gene_6       1273       1749       1696       2733       1867       1506       1748       1757       2009       1948
## +++++++++++++++++++++
## &gt; subgenome: B 
##        group_1__1 group_1__2 group_1__3 group_1__4 group_1__5 group_2__1 group_2__2 group_2__3 group_2__4 group_2__5
## gene_1         12          3         36          0          7         23         21         19         26         13
## gene_2          6          3          5          2          7          0          0          0          0          0
## gene_3          6          7          9         10          4          8          8         12          8          8
## gene_4         33         12          2          0          1          7          5         11          2          8
## gene_5        202        136        178        156        189        188        167        163        167        153
## gene_6        793        842        918        800        937        989       1112        845        945        992
## ---------------------</code></pre>
<p>Simulated read counts are generated from a negative binomial (NB) distribution.
The mean and dispersion values used for each homeolog are stored in the object returned by <code>sim_homeolog_counts()</code>.
The <code>get_sim_params()</code> function can be used to retrieve these parameters.
For example, to get means used for sampling read counts, run as follows.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="simulating-allotetraploid-data.html#cb101-1" tabindex="-1"></a>param_mu <span class="ot">&lt;-</span> <span class="fu">get_sim_params</span>(x, <span class="st">&quot;mu&quot;</span>)</span>
<span id="cb101-2"><a href="simulating-allotetraploid-data.html#cb101-2" tabindex="-1"></a><span class="fu">names</span>(param_mu)</span></code></pre></div>
<pre><code>## [1] &quot;group_1&quot; &quot;group_2&quot;</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="simulating-allotetraploid-data.html#cb103-1" tabindex="-1"></a><span class="fu">head</span>(param_mu[[<span class="st">&quot;group_1&quot;</span>]])</span></code></pre></div>
<pre><code>##                  A          B
## gene_1   56.491374  17.328355
## gene_2    8.006597   4.818938
## gene_3    5.944184   6.766986
## gene_4   28.174125   7.362780
## gene_5   44.853340 166.388422
## gene_6 1902.944015 899.045310</code></pre>
<p>The output is a list of data frames, one per condition, with columns representing individual subgenomes.
These ground-truth mean values can be used to calculate true homeolog expression ratios for each condition.
Users can then define homeologs that show significant changes in expression ratios between conditions.</p>
<p>Alternatively, the <code>def_sigShift()</code> function can automatically
define homeologs with significant shifts without manual calculations.
For example, to identify homeologs with a maximum absolute ratio difference (<code>Dmax</code>) greater than 0.2
or a maximum odds ratio (<code>ORmax</code>) exceeding 2.0, use the following code.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="simulating-allotetraploid-data.html#cb105-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sim_homeolog_counts</span>()</span>
<span id="cb105-2"><a href="simulating-allotetraploid-data.html#cb105-2" tabindex="-1"></a></span>
<span id="cb105-3"><a href="simulating-allotetraploid-data.html#cb105-3" tabindex="-1"></a>is_sig <span class="ot">&lt;-</span> <span class="fu">def_sigShift</span>(x, <span class="at">Dmax =</span> <span class="fl">0.2</span>, <span class="at">ORmax =</span> <span class="dv">2</span>, <span class="at">operator =</span> <span class="st">&quot;OR&quot;</span>)</span>
<span id="cb105-4"><a href="simulating-allotetraploid-data.html#cb105-4" tabindex="-1"></a><span class="fu">table</span>(is_sig)</span></code></pre></div>
<pre><code>## is_sig
## FALSE  TRUE 
##  9260   740</code></pre>
<p>The output shows the number of homeologs meeting these thresholds.</p>
<p>To visualize the distribution of expression ratios across conditions,
use the <code>plot_HER_distr()</code> function.
This returns a list of histograms, one per condition,
with ratios calculated by default for the first subgenome (<code>base = 1</code>).</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="simulating-allotetraploid-data.html#cb107-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sim_homeolog_counts</span>()</span>
<span id="cb107-2"><a href="simulating-allotetraploid-data.html#cb107-2" tabindex="-1"></a>distr_plots <span class="ot">&lt;-</span> <span class="fu">plot_HER_distr</span>(x)</span></code></pre></div>
<p>Since the simulated dataset contains two groups,
the <code>plot_HER_distr()</code> function returns two histograms.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="simulating-allotetraploid-data.html#cb108-1" tabindex="-1"></a><span class="fu">names</span>(distr_plots)</span></code></pre></div>
<pre><code>## [1] &quot;group_1&quot; &quot;group_2&quot;</code></pre>
<p>To display the distributions for each group, run as follows.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="simulating-allotetraploid-data.html#cb110-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb110-2"><a href="simulating-allotetraploid-data.html#cb110-2" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb110-3"><a href="simulating-allotetraploid-data.html#cb110-3" tabindex="-1"></a></span>
<span id="cb110-4"><a href="simulating-allotetraploid-data.html#cb110-4" tabindex="-1"></a><span class="fu">grid.arrange</span>(distr_plots[[<span class="st">&quot;group_1&quot;</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;group_1&quot;</span>), </span>
<span id="cb110-5"><a href="simulating-allotetraploid-data.html#cb110-5" tabindex="-1"></a>             distr_plots[[<span class="st">&quot;group_2&quot;</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;group_2&quot;</span>),</span>
<span id="cb110-6"><a href="simulating-allotetraploid-data.html#cb110-6" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sim-2x-plotherdistr-plots"></span>
<img src="_main_files/figure-html/sim-2x-plotherdistr-plots-1.png" alt="Distribution of homeolog expression ratios in two simulated groups." width="672" />
<p class="caption">
Figure 5.1: Distribution of homeolog expression ratios in two simulated groups.
</p>
</div>
<p>To compare expression ratios between groups, use the <code>plot_HER()</code> function,
which by default plots ratios for the first subgenome in a scatter plot.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="simulating-allotetraploid-data.html#cb111-1" tabindex="-1"></a><span class="fu">plot_HER</span>(x, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sim-2x-plother"></span>
<img src="_main_files/figure-html/sim-2x-plother-1.png" alt="Changes in homeolog expression ratios between two groups. Each point represents the expression ratio in group 1 (x-axis) and group 2 (y-axis)." width="672" />
<p class="caption">
Figure 5.2: Changes in homeolog expression ratios between two groups. Each point represents the expression ratio in group 1 (x-axis) and group 2 (y-axis).
</p>
</div>
<p>If the dataset was generated using <code>sim_homeolog_counts()</code>,
ground-truth significant shifts can be highlighted as follows using the <code>def_sigShift()</code> function.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="simulating-allotetraploid-data.html#cb112-1" tabindex="-1"></a>is_sig <span class="ot">&lt;-</span> <span class="fu">def_sigShift</span>(x, <span class="at">Dmax =</span> <span class="fl">0.2</span>, <span class="at">ORmax =</span> <span class="fl">2.0</span>)</span>
<span id="cb112-2"><a href="simulating-allotetraploid-data.html#cb112-2" tabindex="-1"></a><span class="fu">plot_HER</span>(x, <span class="at">label =</span> is_sig, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sim-2x-plother-label"></span>
<img src="_main_files/figure-html/sim-2x-plother-label-1.png" alt="Changes in homeolog expression ratios between two groups. Orange points indicate homeologs with significant changes in expression ratios, while gray points represent those without significant changes." width="672" />
<p class="caption">
Figure 5.3: Changes in homeolog expression ratios between two groups. Orange points indicate homeologs with significant changes in expression ratios, while gray points represent those without significant changes.
</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evaluation-framework.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulating-allohexaploid-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  },
  "number_sections": true,
  "biblio-style": "apalike",
  "link-citations": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
